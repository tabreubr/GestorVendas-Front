<div class="container-venda">
  <h2 class="titulo">Registrar Venda</h2>

  <div class="card-venda">
    <form (ngSubmit)="adicionarItem()" class="venda-form">
      <div class="campo">
        <label>Produto:</label>
        <select [(ngModel)]="itemSelecionado.produto" name="produto" required>
          <option [ngValue]="null" disabled selected>Selecione um produto</option>
          <option *ngFor="let p of produtos" [ngValue]="p">
            {{ p.nome }} (Estoque: {{ p.quantidade }})
          </option>
        </select>
      </div>

      <div class="campo">
        <label>Quantidade:</label>
        <input
          type="number"
          [(ngModel)]="itemSelecionado.quantidade"
          name="quantidade"
          min="1"
          [max]="itemSelecionado.produto?.quantidade || 1"
          required
        />
      </div>

      <button type="submit" class="btn-adicionar">Adicionar ao Carrinho</button>
    </form>
  </div>

  <div class="card-carrinho" *ngIf="carrinho.length > 0">
    <h3>Carrinho</h3>
    <ul class="lista-carrinho">
      <li *ngFor="let item of carrinho; let i = index" class="item-carrinho">
        <div>
          <strong>{{ item.produto.nome }}</strong>  
          <br>
          <span>Quantidade: {{ item.quantidade }}</span>
        </div>
        <button (click)="removerItem(i)" class="btn-remover">Remover</button>
      </li>
    </ul>

    <button (click)="registrarVenda()" [disabled]="carrinho.length === 0" class="btn-registrar">
      Registrar Venda
    </button>
  </div>

  <div *ngIf="mensagemSucesso" class="alerta sucesso">
    {{ mensagemSucesso }}
  </div>
  <div *ngIf="mensagemErro" class="alerta erro">
    {{ mensagemErro }}
  </div>
</div>
